<?xml version="1.0" encoding="UTF-8"?>
<wdkModel>

    <!-- *************** -->
    <!-- model querySets -->
    <!-- *************** -->

    <!--
    A "query" obtains tabular values from a data source.  It has columns
    and parameters.  So far, only SQL data sources are supported, but others,
    such as flat files are coming.  

    Queries are used for different purposes: providing primary keys to a 
    question; providing attributes and tables to a record; and, providing
    vocabularies to vocabulary parameters.

    A "query set" is a grouping of queries.  It is useful in organizing the
    model xml file.  

    The full name of a query is of the form "set_name.name."
    -->

    <!-- queries that return controlled vocabulary terms -->

    <querySet name="VocabQueries" queryType="vocab">
        <!-- a query that returns a list of Apicomplexon taxons -->
        <sqlQuery name="ApiTaxon" isCacheable="true">
            <column name="term"/>
            <column name="internal"/>
            <sql>
                select distinct name as term, taxon_id as internal
                from WDKTestTaxonName
                where name in ('Neospora caninum', 'Plasmodium falciparum', 'Eimeria tenella',
                               'Plasmodium yoelii', 'Sarcocystis neurona', 'Toxoplasma gondii')
                order by internal desc
            </sql>
        </sqlQuery>

        <!-- a query that returns a list of EST Libraries -->
        <sqlQuery name="EstLib">
            <column name="term"/>
            <column name="internal"/>
            <sql>
                select distinct dbest_name as term, library_id as internal
                from WDKTestLibrary where dbest_name like 'N%'
            </sql>
        </sqlQuery>

    </querySet>


    <querySet name="SummaryQueries" queryType="summary">

        <sqlQuery name="RnaSummaryQuery" isCacheable="false">
            <paramRef ref="params.sample_sum_row"/>
            <paramRef ref="params.sample_sum_column"/>
            <paramRef ref="params.rna_answer"/>
            <column name="na_sequence_id"/>
            <column name="project_id"/>
            <sql>
                <!-- use CDATA because query includes angle brackets -->
                <![CDATA[
                    SELECT na_sequence_id
                    FROM $$rna_answer$$ a
                ]]>
            </sql>
        </sqlQuery>  

        <sqlQuery name="EstSummaryQuery" isCacheable="false">
            <paramRef ref="params.sample_sum_row"/>
            <paramRef ref="params.sample_sum_column"/>
            <paramRef ref="params.est_answer"/>
            <column name="est_id"/>
            <column name="project_id"/>
            <sql>
                <!-- use CDATA because query includes angle brackets -->
                <![CDATA[
                    SELECT est_id, project_id
                    FROM $$est_answer$$ a
                ]]>
            </sql>
        </sqlQuery>  

    </querySet>
</wdkModel>
